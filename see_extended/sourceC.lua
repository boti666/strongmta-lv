local modelsTable = {
	{12866, "models/CEgroundT202.see", "collision/cegroundt202.see", "textures/ce_ground07.txd", 13474, 314.738, 194.2588, 21.4618},

	{13443, "models/CEwirestown03.see", false, "textures/cunte_wires.txd"},
	
	{13444, "models/CEwirestown07.see", false, "textures/cunte_wires.txd"},
	
	{13040, "models/CE_ground03.see", "collision/ce_ground03.see", "textures/ce_ground01.txd", 13418, 275.644, 284.607, 124.2995},

	{13100, "models/CE_groundPALO02.see", "collision/ce_groundpalo02.see", "textures/ce_ground07.txd", 13111, 349.045, 335.608, 23.14808},

	{13101, "models/ce_groundpalo03.see", "collision/ce_groundpalo03.see", "textures/ce_ground07.txd"},
	
	{13102, "models/CE_groundPALO04.see", "collision/ce_groundpalo04.see", "textures/ce_ground07.txd"},
	
	{13099, "models/CE_groundPALO06.see", "collision/ce_groundpalo06.see", "textures/ce_ground07.txd", 13110, 279.746, 195.7735, 81.3981},

	{13144, "models/cuntEground04.see", "collision/cunteground04.see", "textures/ce_ground04.txd", 13432, 266.711, 264.235, 109.7348},
	
	{13147, "models/cuntEground09.see", "collision/cunteground09.see", "textures/ce_ground05.txd", 13467, 261.619, 270.107, 87.1978},
	
	{12908, "models/cuntEground09b.dff", "collision/cuntEground09b.txd", "textures/cuntEground09b.txd", 13032, 238.695, 286.084, 23.28507},

	{13208, "models/cuntEground15.see", "collision/cuntEground15.see", "textures/ce_ground10.txd", 13228, 267.634, 237.151, 49.4012},

	{13149, "models/cuntEground17.see", "collision/cunteground17.see", "textures/ce_ground05.txd", 13482, 277.10, 267.678, 48.7438},

	{13175, "models/cuntEground18.see", "collision/cunteground18.see", "textures/ce_ground14.txd", 13480, 248.431, 139.3824, 100.1484},

	{13150, "models/cuntEground19.see", "collision/cunteground19.see", "textures/ce_ground05.txd", 13151, 267.028, 275.616, 65.159},

	{12868, "models/cuntEground26.see", "collision/cunteground26.see", "textures/ce_ground05.txd", 13152, 339.53, 184.02, 51.58},

	{13177, "models/cuntEground30.see", false, "textures/ce_ground14.txd", 13183, 126.30, 189.64, 62.27},

	{13178, "models/cuntEground31.see", "collision/cunteground31.see", "textures/ce_ground14.txd", 13479, 143.69, 245.64, 90.96},

	{13180, "models/cuntEground33.see", "collision/cunteground33.see", "textures/ce_ground14.txd", 13186, 138.02, 150.76, 81.45},

	{13210, "models/cuntEground37.see", "collision/cunteground37.see", "textures/ce_ground10.txd", 13472, 97.99, 172.47, 50.73},

	{13211, "models/cuntEground38.see", "collision/cunteground38.see", "textures/ce_ground10.txd", 13473, 275.60, 284.76, 68.20},

	{12904, "models/cuntetownrd1.see", "collision/cuntetownrd1.see", "textures/cunteroads5.txd", 13291, 273.02, 88.25, 17.23},

	{12802, "models/cunte_roads04.see", "collision/cunte_roads04.see", "textures/cunteroads2.txd", 13319, 41.09, 226.67, 19.52},

	{12993, "models/cunte_roads09.see", "collision/cunte_roads09.see", "textures/cunteroads2.txd", 13284, 90.00, 70.00, 0.17},

	{12811, "models/cunte_roads13.see", "collision/cunte_roads13.see", "textures/cunteroads2.txd", 13303, 24.51, 195.63, 36.91},

	{12812, "models/cunte_roads14.see", "collision/cunte_roads14.see", "textures/cunteroads2.txd", 13283, 125.16, 263.18, 38.74},

	{12826, "models/cunte_roads23.see", false, "textures/cunteroads5.txd", 13352, 206.40, 190.46, 14.84},

	{13348, "models/cunte_roads23W.see", "collision/cunte_roads23w.see", "textures/cunteroads5.txd", 13354, 190.72, 117.18, 18.53},

	{12829, "models/cunte_roads26.see", "collision/cunte_roads26.see", "textures/cunteroads5.txd", 13350, 268.96, 108.49, 5.79},

	{12852, "models/cunte_roads30.see", "collision/cunte_roads30.see", "textures/cunteroads1.txd", 13233, 307.00, 176.74, 13.76},

	{13153, "models/cunte_roads30bar03.see", "collision/cunte_roads30bar03.see", "textures/cunteroads1.txd"},

	{12875, "models/cunte_roads35.see", "collision/cunte_roads35.see", "textures/cunteroads1.txd", 13376, 261.57, 300.73, 33.32},

	{12885, "models/cunte_roads48.see", "collision/cunte_roads48.see", "textures/cunteroads4.txd", 13331, 135.01, 238.54, 21.38},

	{12886, "models/cunte_roads49.see", "collision/cunte_roads49.see", "textures/cunteroads5.txd", 13351, 73.01, 150.17, 12.27},

	{12887, "models/cunte_roads50.see", "collision/cunte_roads50.see", "textures/cunteroads6.txd", 13274, 22.34, 292.69, 7.94},

	{12888, "models/cunte_roads51.see", "collision/cunte_roads51.see", "textures/cunteroads6.txd", 13330, 90.73, 197.52, 3.32},

	{12889, "models/cunte_roads52.see", "collision/cunte_roads52.see", "textures/cunteroads6.txd", 13346, 51.01, 218.65, 3.33},

	{12890, "models/cunte_roads54.see", "collision/cunte_roads54.see", "textures/cunteroads6.txd", 13328, 228.43, 233.34, 11.90},
	
	{8859, "models/vgsEcoast05.see", "collision/vgsecoast05.see", "textures/vgsecoast.txd"},
}

--[[
local startX, startY, startZ = -1197.6359863281, 242.31330871582, 89.490356445312

addEventHandler("onClientRender", getRootElement(),
	function()
		for k = 1, 75 do
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 100, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 100, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 200, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 200, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 300, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 300, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 400, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 400, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 500, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 500, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
			dxDrawLine3D(-1197.6359863281 + k * 50, 242.31330871582 - 600, 89.490356445312, -1197.6359863281 + k * 50, 242.31330871582 - 600, 89.490356445312 - 100, tocolor(255, 0, 0), 50)
		end
	end
)
]]

addEvent("gotKey", true)
addEventHandler("gotKey", getRootElement(),
	function(keys)
		lockedModelsKey = keys

		setTimer(function()
			loadExtendModels()
		end, 5000, 1)
	end
)

function loadExtendModels()
	for i, v in ipairs(modelsTable) do
		if v[4] then
			if fileExists(v[4]) then
				local txdImage = engineLoadTXD(v[4])

				if txdImage then
					engineImportTXD(txdImage, v[1])

					if v[5] then
						engineImportTXD(txdImage, v[5])
					end
				end
			end
		end

		if v[3] then
			if fileExists(v[3]) then

				if lockedModelsKey[v[3]] then
					local file = fileOpen(v[3])
					local fileSize = fileGetSize(file)
					local fileData = fileRead(file, fileSize)

					local colImage = engineLoadCOL(teaDecodeBinary(fileData, lockedModelsKey[v[3]]))

					if colImage then
						engineReplaceCOL(colImage, v[1])
					end
				else
					local colImage = engineLoadCOL(v[3])

					if colImage then
						engineReplaceCOL(colImage, v[1])
					end
				end
			end
		end

		if v[2] then
			if fileExists(v[2]) then

				if lockedModelsKey[v[2]] then
					local file = fileOpen(v[2])
					local fileSize = fileGetSize(file)
					local fileData = fileRead(file, fileSize)

					local dffImage = engineLoadDFF(teaDecodeBinary(fileData, lockedModelsKey[v[2]]))

					if dffImage then
						engineReplaceModel(dffImage, v[1])
						engineSetModelLODDistance(v[1], 300)
					end

					if v[5] then
						local dffImage = engineLoadDFF(teaDecodeBinary(fileData, lockedModelsKey[v[2]]))

						if dffImage then
							engineReplaceModel(dffImage, v[5])
						end
					end
				else
					local dffImage = engineLoadDFF(v[2])

					if dffImage then
						engineReplaceModel(dffImage, v[1])
						engineSetModelLODDistance(v[1], 300)
					end
				end
			end
		end
	end
end

function teaDecodeBinary(data, key)
    return base64Decode(teaDecode(data, key))
end

addEventHandler("onClientResourceStart", resourceRoot,
	function()
		triggerServerEvent("getExtendKeys", localPlayer)
	end
)

function assignLOD(element)
    local lod = createObject(getElementModel(element), 0, 0, 0, 0, 0, 0, true)

    setElementDimension(lod, getElementDimension(element))
    setElementPosition(lod, getElementPosition(element))
    setElementRotation(lod, getElementRotation(element))
    setElementCollisionsEnabled(lod, false)
    setLowLODElement(element, lod)

    return lod
end